<section style="margin-top:18px">

  <!-- 1️⃣ Reach Flags -->
  <h2>Reach Flags</h2>
  <div class="grid" id="reachFlags"></div>

  <!-- 2️⃣ Delay Flags -->
  <h2>Delay Flags</h2>
  <div class="grid" id="delayFlags"></div>

  <!-- 3️⃣ Special / Limited Time Flags -->
  <h2>Special / Limited Time Flags</h2>
  <div class="grid" id="specialFlags"></div>

  <!-- 4️⃣ Ping Flags -->
  <h2>Ping Flags</h2>
  <div class="grid" id="pingFlags"></div>

  <!-- 5️⃣ Miscellaneous -->
  <h2>Miscellaneous</h2>
  <div class="grid" id="miscFlags"></div>

</section>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const CATEGORIES = {
    reachFlags: [
      {id:1,name:'Red Reach Flag',desc:'High reach, fast delivery'},
      {id:2,name:'Blue Reach Flag',desc:'Smooth reach, works on most games'}
    ],
    delayFlags: [
      {id:3,name:'Green Delay Flag',desc:'Reduce delay in actions'},
      {id:4,name:'Yellow Delay Flag',desc:'Moderate delay'}
    ],
    specialFlags: [
      {id:5,name:'Coketf 50ms',desc:'Limited time special'},
      {id:6,name:'Coketf 30ms',desc:'Ultra limited edition'}
    ],
    pingFlags: [
      {id:7,name:'Ping Boost Flag',desc:'Improves ping'},
      {id:8,name:'Ping Stabilizer',desc:'Reduces spikes'}
    ],
    miscFlags: [
      {id:9,name:'Hitbox ESP',desc:'Extra visibility'},
      {id:10,name:'Other Misc',desc:'Various utilities'}
    ]
  }

  const cartModal = document.getElementById('cartModal')
  const cartItemsEl = document.getElementById('cartItems')
  const countEl = document.getElementById('count')
  const totalEl = document.getElementById('total')

  function getCart(){ return JSON.parse(localStorage.getItem('rays_cart')||'{}') }
  function saveCart(c){ localStorage.setItem('rays_cart',JSON.stringify(c)); updateCount() }
  function addToCart(id, name){ 
    const c=getCart(); 
    c[id] = (c[id]||0)+1; 
    saveCart(c); 
    alert(`Added "${name}" to cart. Checkout to DM Ray for price.`)
  }
  function updateCount(){ 
    const c=getCart(); 
    countEl.textContent = Object.values(c).reduce((a,b)=>a+b,0)
  }
  function renderCart(){
    const c=getCart(); 
    cartItemsEl.innerHTML=''
    Object.keys(c).forEach(id=>{
      const qty = c[id]
      const p = Object.values(CATEGORIES).flat().find(x=>x.id==id)
      const line = document.createElement('div')
      line.className='cart-item'
      line.innerHTML = `<div>${p.name} <div class="small">x${qty}</div></div><div>Price in DM</div>`
      cartItemsEl.appendChild(line)
    })
  }

  function openCart(){ renderCart(); cartModal.style.display='block' }
  function closeCart(){ cartModal.style.display='none' }
  function checkout(){
    const c=getCart(); 
    if(Object.keys(c).length==0){ alert('Cart is empty'); return }
    const summary = Object.keys(c).map(id=>{
      const p = Object.values(CATEGORIES).flat().find(x=>x.id==id)
      return `${p.name} x${c[id]}`
    }).join('\n')

    navigator.clipboard.writeText(`Order:\n${summary}\nDiscord: @rattyray1\nServer: https://discord.gg/W8w94pUtgt`)
    window.open('https://discord.gg/W8w94pUtgt','_blank')
    alert('Order summary copied! Message @rattyray1 on Discord to complete purchase. Server invite opened.')
    localStorage.removeItem('rays_cart')
    updateCount()
    closeCart()
  }

  // Render all categories
  Object.keys(CATEGORIES).forEach(catId=>{
    const container = document.getElementById(catId)
    CATEGORIES[catId].forEach(item=>{
      const div = document.createElement('div')
      div.className='card'
      div.innerHTML = `
        <div class="flag">${item.name.split(' ')[0]}</div>
        <div class="name">${item.name}</div>
        <div class="small">${item.desc}</div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
          <div class="price">Price in DM</div>
          <button onclick="addToCart(${item.id}, '${item.name}')">Add</button>
        </div>`
      container.appendChild(div)
    })
  })

  document.getElementById('openCart').addEventListener('click', openCart)
  document.getElementById('closeCart').addEventListener('click', closeCart)
  document.getElementById('checkoutBtn').addEventListener('click', checkout)
  updateCount()
})
</script>
